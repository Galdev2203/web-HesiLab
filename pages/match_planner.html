<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Planificador de Partidos - HesiLab</title>

  <!-- CSS -->
  <link rel="stylesheet" href="../css/global.css">
  <link rel="stylesheet" href="../css/unified-header.css">
  <link rel="stylesheet" href="../css/match_planner.css">

  <!-- Analytics -->
  <script src="../js/analytics.js"></script>
</head>
<body class="has-unified-header">


<!-- El header y sidebar se generan dinámicamente con headerComponent.js -->

<main class="planner-main">
  <div class="container">
    <p id="errorMsg" class="error-message" style="display:none;"></p>
    <p id="guestNotice" class="info-message" style="display:none;"></p>

    <div class="row-config">
      <div class="config-field match-type-field">
        <label for="matchType">Tipo de partido</label>
        <select id="matchType">
          <option value="basket" selected>Basket</option>
          <option value="minibasket">Minibasket</option>
        </select>
      </div>

      <div class="team-selector match-title" style="display:flex;">
        <label for="matchTitle">Título del partido:</label>
        <input id="matchTitle" type="text" placeholder="Título del partido" />
      </div>

      <button id="previewPlannerPdf" class="btn btn-secondary" type="button">Previsualizar PDF</button>

      <div id="teamSelectorSection" class="team-selector" style="display:none;">
        <label for="teamSelector">Equipo:</label>
        <select id="teamSelector">
          <option value="">Selecciona un equipo</option>
        </select>
      </div>
    </div>

    <div class="row-positions">
      <details class="positions-collapsible" open>
        <summary>Posiciones</summary>
        <div class="positions-panel">
          <div id="positionNames" class="positions-grid"></div>
        </div>
      </details>
    </div>

    <div class="planner-layout row-main">
      <section class="players-panel">
        <div class="panel-header">
          <h3>Jugadores</h3>
        </div>

        <div id="playersList" class="players-list">
          Selecciona un equipo para cargar jugadores.
        </div>

        <div class="temp-player-card">
          <h4>Jugador temporal</h4>
          <div class="temp-player-form">
            <input id="tempPlayerName" type="text" placeholder="Nombre y apellidos" />
            <input id="tempPlayerNumber" type="text" placeholder="Dorsal" maxlength="3" inputmode="numeric" />
            <button id="addTempPlayerBtn" class="btn btn-primary">Añadir</button>
          </div>
          <p class="temp-player-note">Solo disponible dentro del planificador.</p>
        </div>
      </section>

      <section class="quarters-panel">
        <div class="panel-header quarters-header">
          <h3>Cuartos</h3>
        </div>

        <div class="quarters-content">
          <div id="quartersGrid" class="quarters-grid">
            <!-- Cuartos renderizados dinámicamente -->
          </div>
        </div>
      </section>
    </div>
  </div>
</main>

<!-- Modal para seleccionar jugadores de un hueco -->
<div id="slotModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Seleccionar jugadores</h3>
      <button class="close-modal" aria-label="Cerrar">&times;</button>
    </div>
    <div class="modal-body slot-modal-body">
      <p id="slotModalInfo" class="slot-modal-info"></p>
      <div id="slotModalList" class="slot-modal-list"></div>
    </div>
    <div class="modal-footer">
      <button class="secondary-btn">Cancelar</button>
      <button class="primary-btn">Guardar</button>
    </div>
  </div>
</div>

<!-- Modal para previsualizar PDF -->
<div id="pdfPreviewModal" class="modal">
  <div class="modal-content pdf-preview-content">
    <div class="modal-header">
      <h3>Previsualización PDF</h3>
      <button class="close-modal" aria-label="Cerrar">&times;</button>
    </div>
    <div class="modal-body pdf-preview-body">
      <iframe id="pdfPreviewFrame" title="Previsualización PDF"></iframe>
    </div>
    <div class="modal-footer">
      <button class="secondary-btn">Cerrar</button>
      <button class="primary-btn">Descargar</button>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script type="module" src="../js/match_planner.js"></script>
</body>
</html>
